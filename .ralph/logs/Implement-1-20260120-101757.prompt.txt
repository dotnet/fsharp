*** THIS IS ITERATION 2 - Previous iteration did not pass all DoD ***



Focus on the ❌ items. The ✅ items passed - don't break them.
Check .ralph/PROBLEMS.md for details on what failed.
Check git log and git diff to see what was already done.

SPRINT 1: Write failing test

Create a test in NullableReferenceTypesTests.fs that reproduces the exact issue
   from #18488: when matching a nullable type with `| null -> ...`, the variable in subsequent
   branches should be refined to non-null. The test should use patterns like: `type objnull = obj |
    null; let getEnvAliasObj (_: string) : objnull = failwith "stub"; let valueAliasObj = match
   getEnvAliasObj "ENVVAR" with | null -> "missing" | x -> x.ToString()`. This test should
   verify no nullness warning is emitted for `x.ToString()` since x is known non-null after the
   null case. Also test with `System.Environment.GetEnvironmentVariable` pattern.

Definition of Done (DoD):
- Test
   file compiles
- Test fails when run against main branch (demonstrating the issue exists)
- Test correctly expects no nullness warnings in non-null branches

FIX THESE ISSUES:
-    VERIFY_FAILED

   **Issues found:**

   1. **Fix is incomplete** - The test `Match null branch should refine variable to non-null in
   subsequent branches - type alias` is failing. The type alias case (`type objnull = obj | null`)
   still produces nullness warnings after the null branch is matched. The current fix only updates
   the outer nullness annotation on type abbreviations but doesn't properly resolve the underlying
   nullable type.



IMPORTANT: Read .ralph/VISION.md for context and design decisions.

=== SPRINT COMPLETION REQUIREMENTS ===
This sprint MUST deliver a TESTED, BUILDING product increment.
ALL DoD items must pass for the sprint to be complete.

1. Write/update code AND tests together (not separately)
2. Run build - it MUST succeed
3. Run tests - they MUST pass
4. Verify each DoD criterion is satisfied

Do NOT commit untested code. Tests are part of THIS sprint, not a future one.

If you hit a design obstacle, UPDATE .ralph/VISION.md with your findings.

REPLANNING: If this sprint is impossible, wrong, or should be restructured,
create .ralph/REPLAN.md explaining why and proposing changes. The orchestrator
will trigger replanning. Use this for fundamental issues, not minor obstacles.

═══════════════════════════════════════════════════════
When ALL DoD items are satisfied, COMMIT your changes,
then output: SUBTASK_COMPLETE
═══════════════════════════════════════════════════════

IMPORTANT: Read .ralph/VISION.md for project context and design decisions.
If you hit a design obstacle, UPDATE .ralph/VISION.md with your findings.

=== SHARED CONTEXT ===

Read .ralph/LAST_VALIDATOR.md to see the last validation result.
=== END SHARED CONTEXT ===